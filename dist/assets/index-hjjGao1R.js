import{n as z,q as p,o as M,y as $,v as J,x as t,h as e,A as r,z as l,aB as Y,aH as ce,O as pe,bn as me,bo as _e,F as Z,I as ee,K as te,a$ as ye,b1 as ve,aJ as ae,ax as fe,f as ge,al as L,B as i,ap as V,an as H,az as O,am as x,aj as he,H as be,b3 as xe,L as Se,a_ as we}from"./index-na3ZdG7K.js";import{_ as ke,a as Ae}from"./index-Tw5jmyQP.js";import{_ as Ce}from"./index-FkBCoc7J.js";import{b as Be,_ as $e,a as Ie}from"./index-bKb2Kxvo.js";import"./Checkbox-gjcEnFOk.js";import"./index-WJYpY2fB.js";import"./index-HVPkVbbu.js";function Ue(y){return z({url:"/salarys/list",method:"get",params:y})}function Ne(y){return z({url:`/salarys/modify/${y}`,method:"get"})}function Pe(y,I){return z({url:`/salarys/modify/${y}`,method:"post",data:I})}function Te(){return z({url:"/salarys/settings",method:"get"})}function je(y){return z({url:"/salarys/settings",method:"post",data:y})}const Oe=l("span",null,"如果201806月工资中扣除2018年6月自然月的社保公积金，请选择当月；如果扣除2018年7月自然月的社保公积金，请选择次月。",-1),ze=l("span",null,"计算工资时的五险一金金额将取自社保报表。",-1),Fe=l("span",null,"计算工资时的考勤数据将取自考勤统计表。",-1),Re={class:"flex items-center"},We=l("span",null,"每出勤日：金额*实际出勤天数； 每计薪日：金额*计薪天数； 每月固定：固定金额； 每月（按出勤日）：金额*实际出勤天数/应出勤工作日； 每月（按计薪日）：金额*计薪天数/计薪标准（如21.75）；",-1),Ee={class:"mt-2 flex items-center"},De=l("span",null,"每出勤日：金额*实际出勤天数； 每计薪日：金额*计薪天数； 每月固定：固定金额； 每月（按出勤日）：金额*实际出勤天数/应出勤工作日； 每月（按计薪日）：金额*计薪天数/计薪标准（如21.75）；",-1),qe={class:"mt-2 flex items-center"},Ke=l("span",null,"每出勤日：金额*实际出勤天数； 每计薪日：金额*计薪天数； 每月固定：固定金额； 每月（按出勤日）：金额*实际出勤天数/应出勤工作日； 每月（按计薪日）：金额*计薪天数/计薪标准（如21.75）；",-1),Le={class:"mt-2 flex items-center"},Ve=l("span",null,"每出勤日：金额*实际出勤天数； 每计薪日：金额*计薪天数； 每月固定：固定金额； 每月（按出勤日）：金额*实际出勤天数/应出勤工作日； 每月（按计薪日）：金额*计薪天数/计薪标准（如21.75）；",-1),He={__name:"SalarySetting",props:{open:{type:Boolean,default:!1}},emits:["cancel"],setup(y,{emit:I}){const k=I,U=y,F=p("piecework"),R=p({}),W=async()=>{const g=await Te();R.value=g,n.value={...n.value,...g}};M(()=>{W()});const P=p(!1),v=p(null),A=p({socialSecurityType:1}),T={socialSecurityType:[{required:!0,message:"请选择社保自然月",trigger:"change"}]},j=p(null),n=p({generalPlan:"",remark:"",transportationSubsidyScheme:1,transportationSubsidyAmount:"",communicationSubsidyScheme:1,communicationSubsidyAmount:"",lunchAllowanceScheme:2,lunchAllowanceAmount:"",housingSubsidyScheme:2,housingSubsidyAmount:"",taxCalculationType:1}),f={socialSecurityType:[{required:!0,message:"请选择社保自然月",trigger:"change"}]},E=()=>{k("cancel")},S=async()=>{P.value=!0,await je(n.value),P.value=!1,Y.success("更新设置成功!"),k("cancel")};return(g,s)=>{const c=ce,C=pe,_=me,h=_e,b=Z,m=ee,N=te,D=ye,d=ke,a=ve,w=ae;return $(),J(w,{open:U.open,title:"设置",onOk:S,onCancel:E,destroyOnClose:!0,"confirm-loading":P.value},{default:t(()=>[e(a,{activeKey:F.value,"onUpdate:activeKey":s[12]||(s[12]=o=>F.value=o)},{default:t(()=>[e(D,{key:"piecework",tab:"计薪设置"},{default:t(()=>[e(N,{ref_key:"pieceworkFormRef",ref:v,model:A.value,rules:T,"label-col":{style:{width:"150px"}}},{default:t(()=>[e(b,{label:"对应社保自然月",name:"socialSecurityType"},{default:t(()=>[e(C,{value:A.value.socialSecurityType,"onUpdate:value":s[0]||(s[0]=o=>A.value.socialSecurityType=o),style:{width:"80%"}},{default:t(()=>[e(c,{value:1},{default:t(()=>[r("当月")]),_:1}),e(c,{value:2},{default:t(()=>[r("次月")]),_:1})]),_:1},8,["value"]),e(h,{placement:"right"},{title:t(()=>[Oe]),default:t(()=>[e(_,{style:{"font-size":"16px","margin-left":"10px"}})]),_:1})]),_:1}),e(b,{label:"社保数据来源"},{default:t(()=>[e(m,{disabled:"",value:"社保模块",style:{width:"80%"}}),e(h,{placement:"right"},{title:t(()=>[ze]),default:t(()=>[e(_,{style:{"font-size":"16px","margin-left":"10px"}})]),_:1})]),_:1}),e(b,{label:"考勤数据来源"},{default:t(()=>[e(m,{disabled:"",value:"考勤模块",style:{width:"80%"}}),e(h,{placement:"right"},{title:t(()=>[Fe]),default:t(()=>[e(_,{style:{"font-size":"16px","margin-left":"10px"}})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(D,{key:"allowance",tab:"津贴设置"},{default:t(()=>[e(N,{ref_key:"allowanceFormRef",ref:j,model:n.value,rules:f,"label-col":{style:{width:"110px"}}},{default:t(()=>[e(b,{label:"通用方案"},{default:t(()=>[e(m,{value:n.value.generalPlan,"onUpdate:value":s[1]||(s[1]=o=>n.value.generalPlan=o),placeholder:"请输入通用方案"},null,8,["value"])]),_:1}),e(b,{label:"备注"},{default:t(()=>[e(m,{value:n.value.remark,"onUpdate:value":s[2]||(s[2]=o=>n.value.remark=o),placeholder:"请输入通用备注","show-count":"",maxlength:100},null,8,["value"])]),_:1}),e(b,{label:"津贴名称"},{default:t(()=>[l("div",Re,[e(m,{value:n.value.transportationSubsidyAmount,"onUpdate:value":s[4]||(s[4]=o=>n.value.transportationSubsidyAmount=o)},{addonBefore:t(()=>[r(" 交通补贴 ")]),addonAfter:t(()=>[e(C,{value:n.value.transportationSubsidyScheme,"onUpdate:value":s[3]||(s[3]=o=>n.value.transportationSubsidyScheme=o),style:{width:"100px"}},{default:t(()=>[e(c,{value:1},{default:t(()=>[r("每出勤日")]),_:1}),e(c,{value:2},{default:t(()=>[r("每月固定")]),_:1})]),_:1},8,["value"])]),_:1},8,["value"]),e(h,{placement:"right"},{title:t(()=>[We]),default:t(()=>[e(_,{style:{"font-size":"16px","margin-left":"10px"}})]),_:1})]),l("div",Ee,[e(m,{value:n.value.communicationSubsidyAmount,"onUpdate:value":s[6]||(s[6]=o=>n.value.communicationSubsidyAmount=o)},{addonBefore:t(()=>[r(" 交通补贴 ")]),addonAfter:t(()=>[e(C,{value:n.value.communicationSubsidyScheme,"onUpdate:value":s[5]||(s[5]=o=>n.value.communicationSubsidyScheme=o),style:{width:"100px"}},{default:t(()=>[e(c,{value:1},{default:t(()=>[r("每出勤日")]),_:1}),e(c,{value:2},{default:t(()=>[r("每月固定")]),_:1})]),_:1},8,["value"])]),_:1},8,["value"]),e(h,{placement:"right"},{title:t(()=>[De]),default:t(()=>[e(_,{style:{"font-size":"16px","margin-left":"10px"}})]),_:1})]),l("div",qe,[e(m,{value:n.value.lunchAllowanceAmount,"onUpdate:value":s[8]||(s[8]=o=>n.value.lunchAllowanceAmount=o)},{addonBefore:t(()=>[r(" 午餐补贴 ")]),addonAfter:t(()=>[e(C,{value:n.value.lunchAllowanceScheme,"onUpdate:value":s[7]||(s[7]=o=>n.value.lunchAllowanceScheme=o),style:{width:"100px"}},{default:t(()=>[e(c,{value:1},{default:t(()=>[r("每出勤日")]),_:1}),e(c,{value:2},{default:t(()=>[r("每月固定")]),_:1})]),_:1},8,["value"])]),_:1},8,["value"]),e(h,{placement:"right"},{title:t(()=>[Ke]),default:t(()=>[e(_,{style:{"font-size":"16px","margin-left":"10px"}})]),_:1})]),l("div",Le,[e(m,{value:n.value.housingSubsidyAmount,"onUpdate:value":s[10]||(s[10]=o=>n.value.housingSubsidyAmount=o)},{addonBefore:t(()=>[r(" 住房补贴 ")]),addonAfter:t(()=>[e(C,{value:n.value.housingSubsidyScheme,"onUpdate:value":s[9]||(s[9]=o=>n.value.housingSubsidyScheme=o),style:{width:"100px"}},{default:t(()=>[e(c,{value:1},{default:t(()=>[r("每出勤日")]),_:1}),e(c,{value:2},{default:t(()=>[r("每月固定")]),_:1})]),_:1},8,["value"])]),_:1},8,["value"]),e(h,{placement:"right"},{title:t(()=>[Ve]),default:t(()=>[e(_,{style:{"font-size":"16px","margin-left":"10px"}})]),_:1})])]),_:1}),e(b,{label:"适用计税方式",name:"taxCalculationType"},{default:t(()=>[e(d,{value:n.value.taxCalculationType,"onUpdate:value":s[11]||(s[11]=o=>n.value.taxCalculationType=o),options:[{label:"税前",value:1},{label:"税后",value:2}]},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["activeKey"])]),_:1},8,["open","confirm-loading"])}}},Me={class:"bg-white p-2"},Je={class:"mt-2 flex items-center"},Qe={class:"flex items-center"},Ge=l("span",{class:"text-base",style:{width:"80px"}},"聘用形式：",-1),Xe={class:"flex items-center"},Ye=l("span",{class:"text-base text-right",style:{width:"80px"}},"部门：",-1),Ze={class:"mt-4 p-2 bg-white"},et={class:"flex justify-end p-2 bg-white"},tt=l("span",{class:"inline-block text-right leading-snug",style:{width:"70px"}},"姓名：",-1),at=l("span",{class:"inline-block text-right leading-snug",style:{width:"70px"}},"部门：",-1),lt=l("span",{class:"inline-block text-right leading-snug",style:{width:"70px"}},"手机号：",-1),nt=l("span",{class:"inline-block text-right leading-snug",style:{width:"70px"}},"入职时间：",-1),st={class:"flex items-center"},ot=l("div",{style:{width:"10%"},class:"text-center"},x("-->"),-1),ut={class:"flex items-center"},it=l("div",{style:{width:"10%"},class:"text-center"},x("-->"),-1),rt={class:"flex items-center"},dt=l("div",{style:{width:"10%"},class:"text-center"},x("-->"),-1),ht={__name:"index",setup(y){const I=p([]),k=p([]),U=p([]);M(()=>{F()});const F=async()=>{const d=await fe();I.value=d},R=(d,a)=>a.some(w=>w.name.toLowerCase().indexOf(d.toLowerCase())>-1),W=()=>{j()},P=[{name:"序号",dataIndex:"id",key:"id",width:60},{title:"姓名",dataIndex:"username",key:"username"},{title:"手机",dataIndex:"mobile",key:"mobile",width:120},{title:"工号",dataIndex:"workNumber",key:"workNumber",width:120,sorter:(d,a)=>d.workNumber.slice(5)-a.workNumber.slice(5)},{title:"聘用形式",dataIndex:"formOfEmployment",key:"formOfEmployment"},{title:"部门",dataIndex:"departmentName",key:"departmentName"},{title:"入职时间",dataIndex:"timeOfEntry",key:"timeOfEntry"},{title:"工资基数",dataIndex:"currentBasicSalary",key:"currentBasicSalary",sorter:(d,a)=>d.currentBasicSalary-a.currentBasicSalary},{title:"津贴方案",dataIndex:"subsidyName",key:"subsidyName",sorter:(d,a)=>d.subsidyName-a.subsidyName},{title:"操作",key:"action",width:160,fixed:"right"}],v=p({page:1,pagesize:10,approvalsTypeChecks:"",departmentChecks:""}),A=p([]),T=p(!1),j=async()=>{T.value=!0;const d=await Ue({...v.value,approvalsTypeChecks:U.value.flat().join(","),departmentChecks:k.value.flat().join(",")});A.value=d,T.value=!1};M(()=>{j()});const n=(d,a)=>{v.page=d,v.pagesize=a,j()},f=p({}),E=p(null),S=p(!1),g=p({}),s=async d=>{g.value=d;const a=await Ne(d.id);f.value=a,S.value=!0},c=p({userId:"",currentBasicSalary:"",currentPostWage:""}),C={currentBasicSalary:[{required:!0,message:"请输入基本工资",trigger:"blur"}],currentPostWage:[{required:!0,message:"请输入岗位工资",trigger:"blur"}]},_=ge(()=>{let d=Number(f.value.currentBasicSalary)+Number(f.value.currentPostWage),a=Number(c.value.currentBasicSalary)+Number(c.value.currentPostWage),w=(a-d).toFixed(2);return{currentTotal:d,afterTotal:a,adjustRange:w}}),h=()=>{c.value={currentBasicSalary:"",currentPostWage:""},E.value.resetFields(),S.value=!1},b=async()=>{await Pe(f.value.userId,{...c.value,userId:f.value.userId}),Y.success("调整成功!"),S.value=!1,c.value={currentBasicSalary:"",currentPostWage:""}},m=p(!1),N=p(!0),D=()=>{N.value=!1,m.value=!1,he(()=>{N.value=!0})};return(d,a)=>{var G;const w=be,o=xe,le=Ce,ne=Ae,q=Be,se=$e,oe=Se,ue=Ie,B=ee,Q=we,K=Z,ie=te,re=ae;return $(),L("div",null,[l("div",Me,[e(w,{type:"primary",onClick:a[0]||(a[0]=u=>m.value=!0)},{default:t(()=>[r("设置")]),_:1}),l("div",Je,[l("div",Qe,[Ge,e(o,{value:i(U),"onUpdate:value":a[1]||(a[1]=u=>V(U)?U.value=u:null),style:{width:"300px"},multiple:"",options:[{name:"正式",id:1},{name:"非正式",id:2}],placeholder:"请选择聘用形式筛选项","show-search":{filter:R},"field-names":{label:"name",value:"id",children:"children"},"max-tag-count":"responsive",onChange:W},null,8,["value","show-search"])]),l("div",Xe,[Ye,e(o,{value:i(k),"onUpdate:value":a[2]||(a[2]=u=>V(k)?k.value=u:null),style:{width:"300px"},multiple:"",options:i(I),placeholder:"请选择部门筛选项","show-search":{filter:R},"field-names":{label:"name",value:"id",children:"children"},"max-tag-count":"responsive",onChange:W},null,8,["value","options","show-search"])])])]),l("div",Ze,[e(le,{columns:P,rowKey:"id","data-source":i(A).rows,pagination:!1,loading:i(T),scroll:{x:1100}},{headerCell:t(({column:u})=>[u.key==="id"?($(),L(H,{key:0},[r(" ID ")],64)):O("",!0)]),bodyCell:t(({column:u,record:X,index:de})=>[u.key==="id"?($(),L(H,{key:0},[r(x(de+1),1)],64)):O("",!0),u.key==="formOfEmployment"?($(),L(H,{key:1},[r(x(X.formOfEmployment==1?"正式":"非正式"),1)],64)):O("",!0),u.key==="action"?($(),J(w,{key:2,type:"link",onClick:ct=>s(X)},{default:t(()=>[r("调薪")]),_:2},1032,["onClick"])):O("",!0)]),_:1},8,["data-source","loading"]),l("div",et,[e(ne,{current:i(v).page,"onUpdate:current":a[3]||(a[3]=u=>i(v).page=u),"page-size":i(v).pagesize,"onUpdate:pageSize":a[4]||(a[4]=u=>i(v).pagesize=u),"show-quick-jumper":"",total:(G=i(A))==null?void 0:G.total,"show-total":u=>`共 ${u} 条`,onChange:n},null,8,["current","page-size","total","show-total"])])]),e(re,{open:i(S),"onUpdate:open":a[7]||(a[7]=u=>V(S)?S.value=u:null),title:"调整薪水",onOk:b,destroyOnClose:!0,onCancel:h},{default:t(()=>[e(oe,{title:"基本信息"},{default:t(()=>[e(se,null,{default:t(()=>[e(q,{span:12},{default:t(()=>[tt,r(x(i(g).username),1)]),_:1}),e(q,{span:12},{default:t(()=>[at,r(x(i(g).departmentName),1)]),_:1}),e(q,{span:12},{default:t(()=>[lt,r(x(i(g).mobile),1)]),_:1}),e(q,{span:12},{default:t(()=>[nt,r(x(i(g).timeOfEntry),1)]),_:1})]),_:1})]),_:1}),e(ue),e(ie,{ref_key:"adjustSalaryFormRef",ref:E,model:i(c),rules:C,"label-col":{style:{width:"110px"}}},{default:t(()=>[e(K,{label:"调整基本工资",name:"currentBasicSalary"},{default:t(()=>[l("div",st,[e(Q,null,{default:t(()=>[e(B,{value:i(f).currentBasicSalary,disabled:"",style:{width:"40%"}},null,8,["value"])]),_:1}),ot,e(B,{value:i(c).currentBasicSalary,"onUpdate:value":a[5]||(a[5]=u=>i(c).currentBasicSalary=u),type:"number",style:{width:"40%"},placeholder:"调整后基本工资"},null,8,["value"])])]),_:1}),e(K,{label:"调整岗位工资",name:"currentPostWage"},{default:t(()=>[l("div",ut,[e(Q,null,{default:t(()=>[e(B,{value:i(f).currentPostWage,disabled:"",style:{width:"40%"}},null,8,["value"])]),_:1}),it,e(B,{value:i(c).currentPostWage,"onUpdate:value":a[6]||(a[6]=u=>i(c).currentPostWage=u),type:"number",style:{width:"40%"},placeholder:"调整后岗位工资"},null,8,["value"])])]),_:1}),e(K,{label:"工资合计"},{default:t(()=>[l("div",rt,[e(B,{value:_.value.currentTotal,disabled:"",style:{width:"40%"}},null,8,["value"]),dt,e(B,{value:_.value.afterTotal,type:"number",style:{width:"40%"},disabled:"",placeholder:"工资合计"},null,8,["value"])])]),_:1}),e(K,{label:"调整幅度"},{default:t(()=>[e(B,{value:_.value.adjustRange,style:{width:"90%"},disabled:""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"]),i(N)?($(),J(He,{key:0,open:i(m),"onUpdate:open":a[8]||(a[8]=u=>V(m)?m.value=u:null),onCancel:D},null,8,["open"])):O("",!0)])}}};export{ht as default};
