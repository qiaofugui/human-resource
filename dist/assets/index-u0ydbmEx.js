import{n as z,q as c,o as M,y as $,v as J,x as t,h as e,A as d,z as n,aB as Y,aH as re,O as de,bn as ce,bo as pe,F as Z,I as ee,K as te,a$ as me,b1 as _e,aJ as ae,ax as ye,f as ve,al as K,B as r,ap as L,am as V,az as j,an as x,aj as fe,H as ge,b3 as he,L as be,a_ as xe}from"./index-Q24ypCx5.js";import{_ as Se,a as we}from"./index-aTEHUgWY.js";import{_ as ke}from"./index-NvNzMegH.js";import{b as Ae,_ as Ce,a as Be}from"./index-rDYn6oks.js";import"./Checkbox-_FJKXaZ1.js";import"./index-76CVeTAT.js";import"./index-bHu5t3Ki.js";function $e(y){return z({url:"/salarys/list",method:"get",params:y})}function Ie(y){return z({url:`/salarys/modify/${y}`,method:"get"})}function Ue(y,I){return z({url:`/salarys/modify/${y}`,method:"post",data:I})}function Ne(){return z({url:"/salarys/settings",method:"get"})}function Te(y){return z({url:"/salarys/settings",method:"post",data:y})}const Oe=n("span",null,"如果201806月工资中扣除2018年6月自然月的社保公积金，请选择当月；如果扣除2018年7月自然月的社保公积金，请选择次月。",-1),Pe=n("span",null,"计算工资时的五险一金金额将取自社保报表。",-1),je=n("span",null,"计算工资时的考勤数据将取自考勤统计表。",-1),ze={class:"flex items-center"},Fe=n("span",null,"每出勤日：金额*实际出勤天数； 每计薪日：金额*计薪天数； 每月固定：固定金额； 每月（按出勤日）：金额*实际出勤天数/应出勤工作日； 每月（按计薪日）：金额*计薪天数/计薪标准（如21.75）；",-1),Re={class:"mt-2 flex items-center"},Ee=n("span",null,"每出勤日：金额*实际出勤天数； 每计薪日：金额*计薪天数； 每月固定：固定金额； 每月（按出勤日）：金额*实际出勤天数/应出勤工作日； 每月（按计薪日）：金额*计薪天数/计薪标准（如21.75）；",-1),We={class:"mt-2 flex items-center"},De=n("span",null,"每出勤日：金额*实际出勤天数； 每计薪日：金额*计薪天数； 每月固定：固定金额； 每月（按出勤日）：金额*实际出勤天数/应出勤工作日； 每月（按计薪日）：金额*计薪天数/计薪标准（如21.75）；",-1),qe={class:"mt-2 flex items-center"},Ke=n("span",null,"每出勤日：金额*实际出勤天数； 每计薪日：金额*计薪天数； 每月固定：固定金额； 每月（按出勤日）：金额*实际出勤天数/应出勤工作日； 每月（按计薪日）：金额*计薪天数/计薪标准（如21.75）；",-1),Le={__name:"SalarySetting",props:{open:{type:Boolean,default:!1}},emits:["cancel"],setup(y,{emit:I}){const w=I,U=y,F=c("piecework"),R=c({}),E=async()=>{const P=await Ne();R.value=P,s.value={...s.value,...P}};M(()=>{E()});const N=c(!1),f=c(null),k=c({socialSecurityType:1}),T={socialSecurityType:[{required:!0,message:"请选择社保自然月",trigger:"change"}]},O=c(null),s=c({generalPlan:"",remark:"",transportationSubsidyScheme:1,transportationSubsidyAmount:"",communicationSubsidyScheme:1,communicationSubsidyAmount:"",lunchAllowanceScheme:2,lunchAllowanceAmount:"",housingSubsidyScheme:2,housingSubsidyAmount:"",taxCalculationType:1}),g={socialSecurityType:[{required:!0,message:"请选择社保自然月",trigger:"change"}]},A=()=>{w("cancel")},C=async()=>{N.value=!0,await Te(s.value),N.value=!1,Y.success("更新设置成功!"),w("cancel")};return(P,l)=>{const m=re,h=de,b=ce,p=pe,_=Z,v=ee,i=te,a=me,S=Se,W=_e,H=ae;return $(),J(H,{open:U.open,title:"设置",onOk:C,onCancel:A,destroyOnClose:!0,"confirm-loading":N.value},{default:t(()=>[e(W,{activeKey:F.value,"onUpdate:activeKey":l[12]||(l[12]=o=>F.value=o)},{default:t(()=>[e(a,{key:"piecework",tab:"计薪设置"},{default:t(()=>[e(i,{ref_key:"pieceworkFormRef",ref:f,model:k.value,rules:T,"label-col":{style:{width:"150px"}}},{default:t(()=>[e(_,{label:"对应社保自然月",name:"socialSecurityType"},{default:t(()=>[e(h,{value:k.value.socialSecurityType,"onUpdate:value":l[0]||(l[0]=o=>k.value.socialSecurityType=o),style:{width:"80%"}},{default:t(()=>[e(m,{value:1},{default:t(()=>[d("当月")]),_:1}),e(m,{value:2},{default:t(()=>[d("次月")]),_:1})]),_:1},8,["value"]),e(p,{placement:"right"},{title:t(()=>[Oe]),default:t(()=>[e(b,{style:{"font-size":"16px","margin-left":"10px"}})]),_:1})]),_:1}),e(_,{label:"社保数据来源"},{default:t(()=>[e(v,{disabled:"",value:"社保模块",style:{width:"80%"}}),e(p,{placement:"right"},{title:t(()=>[Pe]),default:t(()=>[e(b,{style:{"font-size":"16px","margin-left":"10px"}})]),_:1})]),_:1}),e(_,{label:"考勤数据来源"},{default:t(()=>[e(v,{disabled:"",value:"考勤模块",style:{width:"80%"}}),e(p,{placement:"right"},{title:t(()=>[je]),default:t(()=>[e(b,{style:{"font-size":"16px","margin-left":"10px"}})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(a,{key:"allowance",tab:"津贴设置"},{default:t(()=>[e(i,{ref_key:"allowanceFormRef",ref:O,model:s.value,rules:g,"label-col":{style:{width:"110px"}}},{default:t(()=>[e(_,{label:"通用方案"},{default:t(()=>[e(v,{value:s.value.generalPlan,"onUpdate:value":l[1]||(l[1]=o=>s.value.generalPlan=o),placeholder:"请输入通用方案"},null,8,["value"])]),_:1}),e(_,{label:"备注"},{default:t(()=>[e(v,{value:s.value.remark,"onUpdate:value":l[2]||(l[2]=o=>s.value.remark=o),placeholder:"请输入通用备注","show-count":"",maxlength:100},null,8,["value"])]),_:1}),e(_,{label:"津贴名称"},{default:t(()=>[n("div",ze,[e(v,{value:s.value.transportationSubsidyAmount,"onUpdate:value":l[4]||(l[4]=o=>s.value.transportationSubsidyAmount=o)},{addonBefore:t(()=>[d(" 交通补贴 ")]),addonAfter:t(()=>[e(h,{value:s.value.transportationSubsidyScheme,"onUpdate:value":l[3]||(l[3]=o=>s.value.transportationSubsidyScheme=o),style:{width:"100px"}},{default:t(()=>[e(m,{value:1},{default:t(()=>[d("每出勤日")]),_:1}),e(m,{value:2},{default:t(()=>[d("每月固定")]),_:1})]),_:1},8,["value"])]),_:1},8,["value"]),e(p,{placement:"right"},{title:t(()=>[Fe]),default:t(()=>[e(b,{style:{"font-size":"16px","margin-left":"10px"}})]),_:1})]),n("div",Re,[e(v,{value:s.value.communicationSubsidyAmount,"onUpdate:value":l[6]||(l[6]=o=>s.value.communicationSubsidyAmount=o)},{addonBefore:t(()=>[d(" 交通补贴 ")]),addonAfter:t(()=>[e(h,{value:s.value.communicationSubsidyScheme,"onUpdate:value":l[5]||(l[5]=o=>s.value.communicationSubsidyScheme=o),style:{width:"100px"}},{default:t(()=>[e(m,{value:1},{default:t(()=>[d("每出勤日")]),_:1}),e(m,{value:2},{default:t(()=>[d("每月固定")]),_:1})]),_:1},8,["value"])]),_:1},8,["value"]),e(p,{placement:"right"},{title:t(()=>[Ee]),default:t(()=>[e(b,{style:{"font-size":"16px","margin-left":"10px"}})]),_:1})]),n("div",We,[e(v,{value:s.value.lunchAllowanceAmount,"onUpdate:value":l[8]||(l[8]=o=>s.value.lunchAllowanceAmount=o)},{addonBefore:t(()=>[d(" 午餐补贴 ")]),addonAfter:t(()=>[e(h,{value:s.value.lunchAllowanceScheme,"onUpdate:value":l[7]||(l[7]=o=>s.value.lunchAllowanceScheme=o),style:{width:"100px"}},{default:t(()=>[e(m,{value:1},{default:t(()=>[d("每出勤日")]),_:1}),e(m,{value:2},{default:t(()=>[d("每月固定")]),_:1})]),_:1},8,["value"])]),_:1},8,["value"]),e(p,{placement:"right"},{title:t(()=>[De]),default:t(()=>[e(b,{style:{"font-size":"16px","margin-left":"10px"}})]),_:1})]),n("div",qe,[e(v,{value:s.value.housingSubsidyAmount,"onUpdate:value":l[10]||(l[10]=o=>s.value.housingSubsidyAmount=o)},{addonBefore:t(()=>[d(" 住房补贴 ")]),addonAfter:t(()=>[e(h,{value:s.value.housingSubsidyScheme,"onUpdate:value":l[9]||(l[9]=o=>s.value.housingSubsidyScheme=o),style:{width:"100px"}},{default:t(()=>[e(m,{value:1},{default:t(()=>[d("每出勤日")]),_:1}),e(m,{value:2},{default:t(()=>[d("每月固定")]),_:1})]),_:1},8,["value"])]),_:1},8,["value"]),e(p,{placement:"right"},{title:t(()=>[Ke]),default:t(()=>[e(b,{style:{"font-size":"16px","margin-left":"10px"}})]),_:1})])]),_:1}),e(_,{label:"适用计税方式",name:"taxCalculationType"},{default:t(()=>[e(S,{value:s.value.taxCalculationType,"onUpdate:value":l[11]||(l[11]=o=>s.value.taxCalculationType=o),options:[{label:"税前",value:1},{label:"税后",value:2}]},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["activeKey"])]),_:1},8,["open","confirm-loading"])}}},Ve={class:"bg-white p-2"},He={class:"mt-2 flex items-center"},Me={class:"flex items-center"},Je=n("span",{class:"text-base",style:{width:"80px"}},"聘用形式：",-1),Qe={class:"flex items-center"},Ge=n("span",{class:"text-base text-right",style:{width:"80px"}},"部门：",-1),Xe={class:"mt-4 p-2 bg-white"},Ye={class:"flex justify-end p-2 bg-white"},Ze=n("span",{class:"inline-block text-right leading-snug",style:{width:"70px"}},"姓名：",-1),et=n("span",{class:"inline-block text-right leading-snug",style:{width:"70px"}},"部门：",-1),tt=n("span",{class:"inline-block text-right leading-snug",style:{width:"70px"}},"手机号：",-1),at=n("span",{class:"inline-block text-right leading-snug",style:{width:"70px"}},"入职时间：",-1),lt={class:"flex items-center"},nt=n("div",{style:{width:"10%"},class:"text-center"},x("-->"),-1),st={class:"flex items-center"},ot=n("div",{style:{width:"10%"},class:"text-center"},x("-->"),-1),ut={class:"flex items-center"},it=n("div",{style:{width:"10%"},class:"text-center"},x("-->"),-1),ft={__name:"index",setup(y){const I=c([]),w=c([]),U=c([]);M(()=>{F()});const F=async()=>{const i=await ye();I.value=i},R=(i,a)=>a.some(S=>S.name.toLowerCase().indexOf(i.toLowerCase())>-1),E=()=>{O()},N=[{name:"序号",dataIndex:"id",key:"id",width:60},{title:"姓名",dataIndex:"username",key:"username"},{title:"手机",dataIndex:"mobile",key:"mobile",width:120},{title:"工号",dataIndex:"workNumber",key:"workNumber",width:120,sorter:(i,a)=>i.workNumber.slice(5)-a.workNumber.slice(5)},{title:"聘用形式",dataIndex:"formOfEmployment",key:"formOfEmployment"},{title:"部门",dataIndex:"departmentName",key:"departmentName"},{title:"入职时间",dataIndex:"timeOfEntry",key:"timeOfEntry"},{title:"工资基数",dataIndex:"currentBasicSalary",key:"currentBasicSalary",sorter:(i,a)=>i.currentBasicSalary-a.currentBasicSalary},{title:"津贴方案",dataIndex:"subsidyName",key:"subsidyName",sorter:(i,a)=>i.subsidyName-a.subsidyName},{title:"操作",key:"action",width:160,fixed:"right"}],f=c({page:1,pagesize:10,approvalsTypeChecks:"",departmentChecks:""}),k=c([]),T=c(!1),O=async()=>{T.value=!0;const i=await $e({...f.value,approvalsTypeChecks:U.value.flat().join(","),departmentChecks:w.value.flat().join(",")});k.value=i,T.value=!1};M(()=>{O()});const s=(i,a)=>{f.page=i,f.pagesize=a,O()},g=c({}),A=c(!1),C=c({}),P=async i=>{C.value=i;const a=await Ie(i.id);g.value=a,A.value=!0},l=c({userId:"",currentBasicSalary:"",currentPostWage:""}),m={currentBasicSalary:[{required:!0,message:"请输入基本工资",trigger:"blur"}],currentPostWage:[{required:!0,message:"请输入岗位工资",trigger:"blur"}]},h=ve(()=>{let i=Number(g.value.currentBasicSalary)+Number(g.value.currentPostWage),a=Number(l.value.currentBasicSalary)+Number(l.value.currentPostWage),S=(a-i).toFixed(2);return{currentTotal:i,afterTotal:a,adjustRange:S}}),b=async()=>{await Ue(g.value.userId,{...l.value,userId:g.value.userId}),Y.success("调整成功!"),A.value=!1,l.value={currentBasicSalary:"",currentPostWage:""}},p=c(!1),_=c(!0),v=()=>{_.value=!1,p.value=!1,fe(()=>{_.value=!0})};return(i,a)=>{var G;const S=ge,W=he,H=ke,o=we,D=Ae,le=Ce,ne=be,se=Be,B=ee,Q=xe,q=Z,oe=te,ue=ae;return $(),K(V,null,[n("div",Ve,[e(S,{type:"primary",onClick:a[0]||(a[0]=u=>p.value=!0)},{default:t(()=>[d("设置")]),_:1}),n("div",He,[n("div",Me,[Je,e(W,{value:r(U),"onUpdate:value":a[1]||(a[1]=u=>L(U)?U.value=u:null),style:{width:"300px"},multiple:"",options:[{name:"正式",id:1},{name:"非正式",id:2}],placeholder:"请选择聘用形式筛选项","show-search":{filter:R},"field-names":{label:"name",value:"id",children:"children"},"max-tag-count":"responsive",onChange:E},null,8,["value","show-search"])]),n("div",Qe,[Ge,e(W,{value:r(w),"onUpdate:value":a[2]||(a[2]=u=>L(w)?w.value=u:null),style:{width:"300px"},multiple:"",options:r(I),placeholder:"请选择部门筛选项","show-search":{filter:R},"field-names":{label:"name",value:"id",children:"children"},"max-tag-count":"responsive",onChange:E},null,8,["value","options","show-search"])])])]),n("div",Xe,[e(H,{columns:N,rowKey:"id","data-source":r(k).rows,pagination:!1,loading:r(T),scroll:{x:1100}},{headerCell:t(({column:u})=>[u.key==="id"?($(),K(V,{key:0},[d(" ID ")],64)):j("",!0)]),bodyCell:t(({column:u,record:X,index:ie})=>[u.key==="id"?($(),K(V,{key:0},[d(x(ie+1),1)],64)):j("",!0),u.key==="formOfEmployment"?($(),K(V,{key:1},[d(x(X.formOfEmployment==1?"正式":"非正式"),1)],64)):j("",!0),u.key==="action"?($(),J(S,{key:2,type:"link",onClick:rt=>P(X)},{default:t(()=>[d("调薪")]),_:2},1032,["onClick"])):j("",!0)]),_:1},8,["data-source","loading"]),n("div",Ye,[e(o,{current:r(f).page,"onUpdate:current":a[3]||(a[3]=u=>r(f).page=u),"page-size":r(f).pagesize,"onUpdate:pageSize":a[4]||(a[4]=u=>r(f).pagesize=u),"show-quick-jumper":"",total:(G=r(k))==null?void 0:G.total,"show-total":u=>`共 ${u} 条`,onChange:s},null,8,["current","page-size","total","show-total"])])]),e(ue,{open:r(A),"onUpdate:open":a[7]||(a[7]=u=>L(A)?A.value=u:null),title:"调整薪水",onOk:b,destroyOnClose:!0,onCancel:a[8]||(a[8]=u=>i.adjustSalaryFormRef.resetFields())},{default:t(()=>[e(ne,{title:"基本信息"},{default:t(()=>[e(le,null,{default:t(()=>[e(D,{span:12},{default:t(()=>[Ze,d(x(r(C).username),1)]),_:1}),e(D,{span:12},{default:t(()=>[et,d(x(r(C).departmentName),1)]),_:1}),e(D,{span:12},{default:t(()=>[tt,d(x(r(C).mobile),1)]),_:1}),e(D,{span:12},{default:t(()=>[at,d(x(r(C).timeOfEntry),1)]),_:1})]),_:1})]),_:1}),e(se),e(oe,{ref:"adjustSalaryFormRef",model:r(l),rules:m,"label-col":{style:{width:"110px"}}},{default:t(()=>[e(q,{label:"调整基本工资",name:"currentBasicSalary"},{default:t(()=>[n("div",lt,[e(Q,null,{default:t(()=>[e(B,{value:r(g).currentBasicSalary,disabled:"",style:{width:"40%"}},null,8,["value"])]),_:1}),nt,e(B,{value:r(l).currentBasicSalary,"onUpdate:value":a[5]||(a[5]=u=>r(l).currentBasicSalary=u),type:"number",style:{width:"40%"},placeholder:"调整后基本工资"},null,8,["value"])])]),_:1}),e(q,{label:"调整岗位工资",name:"currentPostWage"},{default:t(()=>[n("div",st,[e(Q,null,{default:t(()=>[e(B,{value:r(g).currentPostWage,disabled:"",style:{width:"40%"}},null,8,["value"])]),_:1}),ot,e(B,{value:r(l).currentPostWage,"onUpdate:value":a[6]||(a[6]=u=>r(l).currentPostWage=u),type:"number",style:{width:"40%"},placeholder:"调整后岗位工资"},null,8,["value"])])]),_:1}),e(q,{label:"工资合计"},{default:t(()=>[n("div",ut,[e(B,{value:h.value.currentTotal,disabled:"",style:{width:"40%"}},null,8,["value"]),it,e(B,{value:h.value.afterTotal,type:"number",style:{width:"40%"},disabled:"",placeholder:"工资合计"},null,8,["value"])])]),_:1}),e(q,{label:"调整幅度"},{default:t(()=>[e(B,{value:h.value.adjustRange,style:{width:"90%"},disabled:""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"]),r(_)?($(),J(Le,{key:0,open:r(p),"onUpdate:open":a[9]||(a[9]=u=>L(p)?p.value=u:null),onCancel:v},null,8,["open"])):j("",!0)],64)}}};export{ft as default};
