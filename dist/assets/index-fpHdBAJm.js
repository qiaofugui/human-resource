import{u as ue,w as le,t as ce,a as de,d as fe,b as ve,c as me,i as ge,e as pe,s as E,f as _,o as _e,g as he,h as u,_ as te,j as be,k as we,l as oe,m as ne,n as X,p as ye,r as ke,q as ae,v as xe,x as m,y as Se,z as R,A as $,B as Ae,C,D as $e,E as Ie,I as ze,F as Oe,G as Ce,H as Re,J as Ne,K as Pe,L as Te}from"./index-en2k_Z5T.js";import{C as We}from"./index-2bFxf6Zr.js";import"./Checkbox-kJ3Q6jzk.js";function Fe(o){return o.replace(/([A-Z])/g,"-$1").toLowerCase()}function Ue(o){return Object.keys(o).map(n=>`${Fe(n)}: ${o[n]};`).join(" ")}function re(){return window.devicePixelRatio||1}function D(o,n,l,s){o.translate(n,l),o.rotate(Math.PI/180*Number(s)),o.translate(-n,-l)}const je=(o,n)=>{let l=!1;return o.removedNodes.length&&(l=Array.from(o.removedNodes).some(s=>s===n)),o.type==="attributes"&&o.target===n&&(l=!0),l};var Be=function(o,n){var l={};for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&n.indexOf(s)<0&&(l[s]=o[s]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(o);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(o,s[c])&&(l[s[c]]=o[s[c]]);return l};function Le(o,n){let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{window:s=fe}=l,c=Be(l,["window"]);let d;const f=ue(()=>s&&"MutationObserver"in s),x=()=>{d&&(d.disconnect(),d=void 0)},h=le(()=>de(o),a=>{x(),f.value&&s&&a&&(d=new MutationObserver(n),d.observe(a,c))},{immediate:!0}),i=()=>{x(),h()};return ce(i),{isSupported:f,stop:i}}const H=2,se=3,Me=()=>({zIndex:Number,rotate:Number,width:Number,height:Number,image:String,content:be([String,Array]),font:we(),rootClassName:String,gap:oe(),offset:oe()}),qe=me({name:"AWatermark",inheritAttrs:!1,props:ge(Me(),{zIndex:9,rotate:-22,font:{},gap:[100,100]}),setup(o,n){let{slots:l,attrs:s}=n;const[,c]=pe(),d=E(),f=E(),x=E(!1),h=_(()=>{var e,t;return(t=(e=o.gap)===null||e===void 0?void 0:e[0])!==null&&t!==void 0?t:100}),i=_(()=>{var e,t;return(t=(e=o.gap)===null||e===void 0?void 0:e[1])!==null&&t!==void 0?t:100}),a=_(()=>h.value/2),S=_(()=>i.value/2),A=_(()=>{var e,t;return(t=(e=o.offset)===null||e===void 0?void 0:e[0])!==null&&t!==void 0?t:a.value}),U=_(()=>{var e,t;return(t=(e=o.offset)===null||e===void 0?void 0:e[1])!==null&&t!==void 0?t:S.value}),N=_(()=>{var e,t;return(t=(e=o.font)===null||e===void 0?void 0:e.fontSize)!==null&&t!==void 0?t:c.value.fontSizeLG}),I=_(()=>{var e,t;return(t=(e=o.font)===null||e===void 0?void 0:e.fontWeight)!==null&&t!==void 0?t:"normal"}),j=_(()=>{var e,t;return(t=(e=o.font)===null||e===void 0?void 0:e.fontStyle)!==null&&t!==void 0?t:"normal"}),F=_(()=>{var e,t;return(t=(e=o.font)===null||e===void 0?void 0:e.fontFamily)!==null&&t!==void 0?t:"sans-serif"}),B=_(()=>{var e,t;return(t=(e=o.font)===null||e===void 0?void 0:e.color)!==null&&t!==void 0?t:c.value.colorFill}),L=_(()=>{var e;const t={zIndex:(e=o.zIndex)!==null&&e!==void 0?e:9,position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none",backgroundRepeat:"repeat"};let r=A.value-a.value,g=U.value-S.value;return r>0&&(t.left=`${r}px`,t.width=`calc(100% - ${r}px)`,r=0),g>0&&(t.top=`${g}px`,t.height=`calc(100% - ${g}px)`,g=0),t.backgroundPosition=`${r}px ${g}px`,t}),b=()=>{f.value&&(f.value.remove(),f.value=void 0)},Y=(e,t)=>{var r;d.value&&f.value&&(x.value=!0,f.value.setAttribute("style",Ue(ne(ne({},L.value),{backgroundImage:`url('${e}')`,backgroundSize:`${(h.value+t)*H}px`}))),(r=d.value)===null||r===void 0||r.append(f.value),setTimeout(()=>{x.value=!1}))},ie=e=>{let t=120,r=64;const g=o.content,z=o.image,v=o.width,p=o.height;if(!z&&e.measureText){e.font=`${Number(N.value)}px ${F.value}`;const w=Array.isArray(g)?g:[g],y=w.map(k=>e.measureText(k).width);t=Math.ceil(Math.max(...y)),r=Number(N.value)*w.length+(w.length-1)*se}return[v??t,p??r]},G=(e,t,r,g,z)=>{const v=re(),p=o.content,w=Number(N.value)*v;e.font=`${j.value} normal ${I.value} ${w}px/${z}px ${F.value}`,e.fillStyle=B.value,e.textAlign="center",e.textBaseline="top",e.translate(g/2,0);const y=Array.isArray(p)?p:[p];y==null||y.forEach((k,P)=>{e.fillText(k??"",t,r+P*(w+se*v))})},M=()=>{var e;const t=document.createElement("canvas"),r=t.getContext("2d"),g=o.image,z=(e=o.rotate)!==null&&e!==void 0?e:-22;if(r){f.value||(f.value=document.createElement("div"));const v=re(),[p,w]=ie(r),y=(h.value+p)*v,k=(i.value+w)*v;t.setAttribute("width",`${y*H}px`),t.setAttribute("height",`${k*H}px`);const P=h.value*v/2,q=i.value*v/2,T=p*v,W=w*v,K=(T+h.value*v)/2,V=(W+i.value*v)/2,J=P+y,Z=q+k,Q=K+y,ee=V+k;if(r.save(),D(r,K,V,z),g){const O=new Image;O.onload=()=>{r.drawImage(O,P,q,T,W),r.restore(),D(r,Q,ee,z),r.drawImage(O,J,Z,T,W),Y(t.toDataURL(),p)},O.crossOrigin="anonymous",O.referrerPolicy="no-referrer",O.src=g}else G(r,P,q,T,W),r.restore(),D(r,Q,ee,z),G(r,J,Z,T,W),Y(t.toDataURL(),p)}};return _e(()=>{M()}),le(()=>[o,c.value.colorFill,c.value.fontSizeLG],()=>{M()},{deep:!0,flush:"post"}),he(()=>{b()}),Le(d,e=>{x.value||e.forEach(t=>{je(t,f.value)&&(b(),M())})},{attributes:!0,subtree:!0,childList:!0,attributeFilter:["style","class"]}),()=>{var e;return u("div",te(te({},s),{},{ref:d,class:[s.class,o.rootClassName],style:[{position:"relative"},s.style]}),[(e=l.default)===null||e===void 0?void 0:e.call(l)])}}}),Ee=ve(qe);function De(o){return X({url:"/sys/login",method:"post",data:o})}function He(){return X({url:"/sys/profile",method:"get"})}function Xe(o){return X({url:`/sys/user/${o}`,method:"get"})}const Ye={class:"login-container"},Ge=R("div",{class:"logo"},null,-1),Ke={class:"form"},Ve=R("h3",{class:"hrsass"},"HRSASS",-1),Je={class:"flex items-center"},Ze={class:"popover flex flex-col"},nt={__name:"index",setup(o){ye();const n=ke({mobile:"",password:"",isAgree:!0}),l=ae(null),c={mobile:[{required:!0,message:"手机号不能为空",trigger:["change","blur"]},{pattern:/^1[3-9]\d{9}$/,message:"手机号格式不正确",trigger:["change","blur"]}],password:[{required:!0,message:"密码不能为空",trigger:["change","blur"]},{pattern:/^.{6,}$/,message:"密码长度必须大于6位",trigger:["change","blur"]}],isAgree:[{validator:(i,a)=>a?Promise.resolve():Promise.reject(new Error("您必须同意用户协议"))}]};let d=ae(!1);const f=async i=>{try{d.value=!0;const{updateToken:a}=$e(),S=await De(i);a(S),await x(),d.value=!1,location.reload()}catch(a){console.log(a,"error"),d.value=!1}},x=async()=>{const i=await He(),a=await Xe(i.userId),{updateUserInfo:S,addAuthorizedRoutes:A}=Ie();a.profile=i,S({...a,roles:i.roles}),A()},h=i=>{switch(i){case"a":n.mobile="13800000002",n.password="hm#qd@23!";break;case"b":n.mobile="18210090582",n.password="hm#qd@23!";break;case"c":n.mobile="18210090789",n.password="hm#qd@23!";break;default:n.mobile="13800000002",n.password="hm#qd@23!";break}l.value.validate()};return(i,a)=>{const S=ze,A=Oe,U=Ce,N=We,I=Re,j=Ne,F=Pe,B=Te,L=Ee;return Se(),xe(L,{content:"qiaofugui.cn",font:{fontSize:14}},{default:m(()=>[R("div",Ye,[Ge,R("div",Ke,[Ve,u(B,{class:"login-card"},{default:m(()=>[u(F,{ref_key:"formRef",ref:l,model:$(n),rules:c,onFinish:f,autocomplete:"off"},{default:m(()=>[u(A,{name:"mobile","has-feedback":""},{default:m(()=>[u(S,{size:"large",value:$(n).mobile,"onUpdate:value":a[0]||(a[0]=b=>$(n).mobile=b)},null,8,["value"])]),_:1}),u(A,{name:"password","has-feedback":""},{default:m(()=>[u(U,{size:"large",value:$(n).password,"onUpdate:value":a[1]||(a[1]=b=>$(n).password=b),onKeyup:Ae(f,["enter"])},null,8,["value"])]),_:1}),u(A,{name:"isAgree"},{default:m(()=>[R("div",Je,[u(N,{checked:$(n).isAgree,"onUpdate:checked":a[2]||(a[2]=b=>$(n).isAgree=b)},{default:m(()=>[C("用户平台使用协议")]),_:1},8,["checked"]),u(j,{trigger:"hover",placement:"top"},{content:m(()=>[R("div",Ze,[u(I,{type:"text",onClick:a[3]||(a[3]=b=>h("a"))},{default:m(()=>[C("填入账号A（管理员）")]),_:1}),u(I,{type:"text",onClick:a[4]||(a[4]=b=>h("b"))},{default:m(()=>[C("填入账号B")]),_:1}),u(I,{type:"text",onClick:a[5]||(a[5]=b=>h("c"))},{default:m(()=>[C("填入账号C")]),_:1})])]),default:m(()=>[u(I,{type:"link"},{default:m(()=>[C("填入账号")]),_:1})]),_:1})])]),_:1}),u(A,null,{default:m(()=>[u(I,{size:"large",type:"primary",block:"",htmlType:"submit",loading:$(d)},{default:m(()=>[C("登录")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1})])])]),_:1})}}};export{nt as default};
