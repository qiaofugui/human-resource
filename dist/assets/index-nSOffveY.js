import{aT as De,m as B,c as ye,aU as be,aV as Ae,aW as ke,aX as Le,q as v,h as t,_ as ee,aS as we,aY as Pe,ae as te,aZ as Oe,a1 as Fe,n as R,E as $e,o as ae,y as c,v as P,x as s,z as n,al as x,am as q,ao as Y,A as l,an as _,az as ne,aB as re,aH as Be,O as Re,F as ze,a_ as He,K as je,a$ as Ne,I as Me,b0 as qe,b1 as Ve,aJ as Ce,ai as Ke,ax as Je,B as C,ap as ce,b2 as We,aj as Ye,H as Ge,b3 as Xe,aO as Ze,J as Qe,ad as et,av as tt,aw as at}from"./index-Q24ypCx5.js";import{_ as nt}from"./index-Ynb7o4zG.js";import{C as lt}from"./index-76CVeTAT.js";import{_ as ot}from"./index-NvNzMegH.js";import{a as st,_ as dt}from"./index-aTEHUgWY.js";import"./Checkbox-_FJKXaZ1.js";import"./index-bHu5t3Ki.js";const ge=()=>({format:String,showNow:te(),showHour:te(),showMinute:te(),showSecond:te(),use12Hours:te(),hourStep:Number,minuteStep:Number,secondStep:Number,hideDisabledOptions:te(),popupClassName:String,status:Oe()});function ut(u){const z=De(u,B(B({},ge()),{order:{type:Boolean,default:!0}})),{TimePicker:G,RangePicker:le}=z,V=ye({name:"ATimePicker",inheritAttrs:!1,props:B(B(B(B({},be()),Ae()),ge()),{addon:{type:Function}}),slots:Object,setup(k,j){let{slots:b,expose:L,emit:g,attrs:N}=j;const D=k,I=ke();Le(!(b.addon||D.addon),"TimePicker","`addon` is deprecated. Please use `v-slot:renderExtraFooter` instead.");const E=v();L({focus:()=>{var f;(f=E.value)===null||f===void 0||f.focus()},blur:()=>{var f;(f=E.value)===null||f===void 0||f.blur()}});const K=(f,M)=>{g("update:value",f),g("change",f,M),I.onFieldChange()},O=f=>{g("update:open",f),g("openChange",f)},$=f=>{g("focus",f)},X=f=>{g("blur",f),I.onFieldBlur()},J=f=>{g("ok",f)};return()=>{const{id:f=I.id.value}=D;return t(G,ee(ee(ee({},N),we(D,["onUpdate:value","onUpdate:open"])),{},{id:f,dropdownClassName:D.popupClassName,mode:void 0,ref:E,renderExtraFooter:D.addon||b.addon||D.renderExtraFooter||b.renderExtraFooter,onChange:K,onOpenChange:O,onFocus:$,onBlur:X,onOk:J}),b)}}}),H=ye({name:"ATimeRangePicker",inheritAttrs:!1,props:B(B(B(B({},be()),Pe()),ge()),{order:{type:Boolean,default:!0}}),slots:Object,setup(k,j){let{slots:b,expose:L,emit:g,attrs:N}=j;const D=k,I=v(),E=ke();L({focus:()=>{var r;(r=I.value)===null||r===void 0||r.focus()},blur:()=>{var r;(r=I.value)===null||r===void 0||r.blur()}});const K=(r,A)=>{g("update:value",r),g("change",r,A),E.onFieldChange()},O=r=>{g("update:open",r),g("openChange",r)},$=r=>{g("focus",r)},X=r=>{g("blur",r),E.onFieldBlur()},J=(r,A)=>{g("panelChange",r,A)},f=r=>{g("ok",r)},M=(r,A,oe)=>{g("calendarChange",r,A,oe)};return()=>{const{id:r=E.id.value}=D;return t(le,ee(ee(ee({},N),we(D,["onUpdate:open","onUpdate:value"])),{},{id:r,dropdownClassName:D.popupClassName,picker:"time",mode:void 0,ref:I,onChange:K,onOpenChange:O,onFocus:$,onBlur:X,onPanelChange:J,onOk:f,onCalendarChange:M}),b)}}});return{TimePicker:V,TimeRangePicker:H}}const{TimePicker:pe,TimeRangePicker:me}=ut(Fe);B(pe,{TimePicker:pe,TimeRangePicker:me,install:u=>(u.component(pe.name,pe),u.component(me.name,me),u)});function rt(u){return R({url:"/attendances",method:"get",params:u})}function it(u){return R({url:"/attendances/adtStatu/list",method:"get",params:u})}function ct(u,z){return R({url:`/attendances/${u}`,method:"put",data:z})}function pt(u){return R({url:"/cfg/atte/item",method:"get",params:u})}function mt(u){return R({url:"/cfg/atte",method:"put",data:u})}function vt(u){return R({url:"/cfg/leave/list",method:"get",params:u})}function _t(u){return R({url:"/cfg/leave",method:"post",data:u})}function ft(u){return R({url:"/cfg/ded/list",method:"get",params:u})}function ht(u){return R({url:"/cfg/deduction",method:"post",data:u})}function gt(u){return R({url:"/cfg/extDuty/item",method:"get",params:u})}function yt(u){return R({url:"/cfg/extDuty",method:"put",data:u})}const bt={style:{"max-height":"600px","overflow-y":"auto"}},kt={key:0,class:"mb-6"},wt={class:"pl-2 mt-2 mb-2",style:{"margin-top":"5px"}},Ct={class:"pl-4"},Ut={class:"mb-2"},St={class:"pl-6"},Tt={class:"mb-2"},xt={class:"mb-2"},It={class:"mb-2"},Et={class:"pl-6"},Dt={class:"mb-2"},At={key:1,class:"mb-6"},Lt={class:"pl-2 mb-2",style:{"margin-top":"5px"}},Pt={class:"pl-4"},Ot={class:"mb-2"},Ft={class:"pl-6"},$t={class:"mb-2"},Bt={class:"mb-2"},Rt={class:"mb-2"},zt={class:"pl-6"},Ht={class:"mb-2"},jt={key:2,class:"mb-6"},Nt={class:"pl-2 mb-2",style:{"margin-top":"5px"}},Mt={class:"pl-4"},qt={class:"mb-2"},Vt={class:"flex mb-2 justify-between items-center"},Kt={class:"mt-2",style:{"padding-left":"18px"}},Jt={__name:"AttendanceSetting",props:{open:{type:Boolean,default:!1},department:{type:Object,default:()=>[]}},emits:["cancel"],setup(u,{emit:z}){const G=$e(),le=z,V=u,H=v("attendance"),k=v(!1),j=v(null),b=v({afternoonEndTime:"",afternoonStartTime:"",companyId:G.userInfo.profile.companyId,departmentId:V.department[0].id,morningEndTime:"",morningStartTime:""}),L=v([]),g=v([]),N=(y,d)=>{var p,m;return((p=L.value)==null?void 0:p.length)>0&&((m=g.value)==null?void 0:m.length)>0?Promise.resolve():Promise.reject(new Error("请选择时间"))},D=()=>{j.value.validateFields("time")},I={departmentId:[{required:!0,message:"部门不能为空",trigger:"change"}],time:[{required:!0,validator:N}]},E=async()=>{const y=await pt({departmentId:b.value.departmentId});L.value=[y.morningStartTime,y.morningEndTime],g.value=[y.afternoonStartTime,y.afternoonEndTime]};ae(()=>{E()});const K=v(null),O=v({departmentId:V.department[0].id}),$={departmentId:[{required:!0,message:"部门不能为空",trigger:"change"}]},X=[{leaveType:"60000",name:"年假"},{leaveType:"60100",name:"事假"},{leaveType:"60200",name:"病假"},{leaveType:"60300",name:"婚假"},{leaveType:"60400",name:"丧假"},{leaveType:"60500",name:"产假"},{leaveType:"60600",name:"奖励产假"},{leaveType:"60700",name:"陪产假"},{leaveType:"60800",name:"探亲假"},{leaveType:"60900",name:"工伤假"},{leaveType:"61000",name:"调休假"},{leaveType:"61100",name:"产检假"},{leaveType:"61200",name:"流产假"},{leaveType:"61300",name:"长期病假"},{leaveType:"61400",name:"其它"}],J=v([]),f=[{title:"假期类型",key:"name",dataIndex:"name"},{title:"是否可用",key:"isEnable",dataIndex:"isEnable"}],M=async()=>{const d=(await vt({departmentId:O.value.departmentId})).map(p=>{const m=X.find(w=>w.leaveType==p.leaveType);return{...p,name:m?m.name:"未知假期",isEnable:p.isEnable==1}});J.value=d};ae(()=>{M()});const r=v(null),A=v({departmentId:V.department[0].id}),oe={departmentId:[{required:!0,message:"部门不能为空",trigger:"change"}]},U=[{dedTypeCode:"51000",name:"迟到扣款"},{dedTypeCode:"52000",name:"早退扣款"},{dedTypeCode:"53000",name:"旷工扣款"}],i=v([]),S=async()=>{const d=(await ft({departmentId:A.value.departmentId})).map(p=>{const m=U.find(w=>w.dedTypeCode==p.dedTypeCode);return{...p,name:m?m.name:"未知扣款",isEnable:p.isEnable==1}});i.value=d};ae(()=>{S()});const W=v(null),h=v({departmentId:V.department[0].id,isClock:"",isCompensationint:"",latestEffectDate:"",rules:[],unit:""}),ve=(y,d)=>h.value.latestEffectDate&&h.value.unit?Promise.resolve():Promise.reject(new Error("请输入调休假")),_e=()=>{W.value.validateFields("latestEffectDate")},fe={departmentId:[{required:!0,message:"部门不能为空",trigger:"change"}],latestEffectDate:[{required:!0,validator:ve}]},se=async()=>{const y=await gt({departmentId:h.value.departmentId}),d=y.extraDutyRuleList.map(p=>({...p,isEnable:p.isEnable==1,isTimeOff:p.isEnable==1,ruleTime:[p.ruleStartTime,p.ruleEndTime]}));h.value={departmentId:Number(y.extraDutyConfig.departmentId),isClock:y.extraDutyConfig.isClock==1,isCompensationint:y.extraDutyConfig.isCompensationint==1,latestEffectDate:y.dayOffConfigs.latestEffectDate,rules:d,unit:y.dayOffConfigs.unit}};ae(()=>{se()});const he=()=>{le("cancel")},F=async()=>{if(H.value==="attendance"&&(b.value.afternoonStartTime=L.value[0],b.value.afternoonEndTime=L.value[1],b.value.morningStartTime=g.value[0],b.value.morningEndTime=g.value[0],k.value=!0,await mt(b.value),E(),re.success("出勤设置更新成功!"),k.value=!1),H.value==="vacate"){let y=J.value.map(d=>({...d,isEnable:d.isEnable?1:0}));k.value=!0,await _t(y),M(),re.success("请假设置更新成功!"),k.value=!1}if(H.value==="charge"){let y=i.value.map(d=>({...d,isEnable:d.isEnable?1:0}));k.value=!0,await ht(y),M(),re.success("扣款设置更新成功!"),k.value=!1}if(H.value==="overtime"){const y=h.value.rules.map(p=>({...p,isEnable:p.isEnable?1:0,isTimeOff:p.isEnable?1:0,ruleEndTime:p.ruleTime[0],ruleStartTime:p.ruleTime[1]}));let d={...h.value,isClock:h.value.isClock?1:0,isCompensationint:h.value.isCompensationint?1:0,rules:y};k.value=!0,await yt(d),se(),re.success("加班设置更新成功!"),k.value=!1}};return(y,d)=>{const p=Be,m=Re,w=ze,a=me,de=He,ue=je,ie=Ne,Q=nt,Ue=ot,T=Me,Se=lt,Te=qe,xe=Ve,Ie=Ce;return c(),P(Ie,{open:V.open,title:"设置",onOk:F,onCancel:he,destroyOnClose:!0,"confirm-loading":k.value,width:580},{default:s(()=>[n("div",bt,[t(xe,{activeKey:H.value,"onUpdate:activeKey":d[10]||(d[10]=e=>H.value=e)},{default:s(()=>[t(ie,{key:"attendance",tab:"出勤设置"},{default:s(()=>[t(ue,{ref_key:"attendanceFormRef",ref:j,model:b.value,rules:I,"label-col":{style:{width:"100px"}}},{default:s(()=>[t(w,{label:"部门",name:"departmentId"},{default:s(()=>[t(m,{value:b.value.departmentId,"onUpdate:value":d[0]||(d[0]=e=>b.value.departmentId=e),placeholder:"请选择部门",onChange:E},{default:s(()=>[(c(!0),x(q,null,Y(u.department,e=>(c(),P(p,{value:e.id},{default:s(()=>[l(_(e.name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])]),_:1}),t(w,{label:"出勤时间",name:"time"},{default:s(()=>[n("div",null,[l(" 上午： "),t(a,{value:L.value,"onUpdate:value":d[1]||(d[1]=e=>L.value=e),format:"HH:mm",valueFormat:"HH:mm",class:"mb-2"},null,8,["value"])]),n("div",null,[t(de,null,{default:s(()=>[l(" 下午： "),t(a,{value:g.value,"onUpdate:value":d[2]||(d[2]=e=>g.value=e),format:"HH:mm",valueFormat:"HH:mm",onChange:D},null,8,["value"])]),_:1})])]),_:1})]),_:1},8,["model"])]),_:1}),t(ie,{key:"vacate",tab:"请假设置"},{default:s(()=>[t(ue,{ref_key:"vacateFormRef",ref:K,model:O.value,rules:$,"label-col":{style:{width:"100px"}}},{default:s(()=>[t(w,{label:"部门",name:"departmentId"},{default:s(()=>[t(m,{value:O.value.departmentId,"onUpdate:value":d[3]||(d[3]=e=>O.value.departmentId=e),placeholder:"请选择部门",onChange:M},{default:s(()=>[(c(!0),x(q,null,Y(u.department,e=>(c(),P(p,{value:e.id},{default:s(()=>[l(_(e.name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])]),_:1}),t(w,{label:"假期设置"},{default:s(()=>[t(Ue,{columns:f,"data-source":J.value,pagination:!1,rowKey:"id"},{bodyCell:s(({column:e,record:o})=>[e.key==="isEnable"?(c(),P(Q,{key:0,checked:o.isEnable,"onUpdate:checked":Ee=>o.isEnable=Ee,size:"small"},null,8,["checked","onUpdate:checked"])):ne("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1},8,["model"])]),_:1}),t(ie,{key:"charge",tab:"扣款设置"},{default:s(()=>[t(ue,{ref_key:"chargeFormRef",ref:r,model:A.value,rules:oe,"label-col":{style:{width:"100px"}}},{default:s(()=>[t(w,{label:"部门",name:"departmentId"},{default:s(()=>[t(m,{value:A.value.departmentId,"onUpdate:value":d[4]||(d[4]=e=>A.value.departmentId=e),placeholder:"请选择部门",onChange:S},{default:s(()=>[(c(!0),x(q,null,Y(u.department,e=>(c(),P(p,{value:e.id},{default:s(()=>[l(_(e.name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])]),_:1}),t(w,{label:"扣款项"},{default:s(()=>[(c(!0),x(q,null,Y(i.value,e=>(c(),x("div",null,[e.dedTypeCode=="51000"?(c(),x("div",kt,[n("div",wt,[l(_(e.name)+" ",1),t(Q,{checked:e.isEnable,"onUpdate:checked":o=>e.isEnable=o,size:"small"},null,8,["checked","onUpdate:checked"])]),n("div",Ct,[n("p",Ut,[l(" 迟到≤ "),t(T,{value:e.periodUpperLimit,"onUpdate:value":o=>e.periodUpperLimit=o,style:{width:"60px"},type:"number"},null,8,["value","onUpdate:value"]),l(" 分钟 ")]),n("div",St,[n("p",Tt,[l(" 迟到≤ "),t(T,{value:e.timesUpperLimit,"onUpdate:value":o=>e.timesUpperLimit=o,style:{width:"60px"},type:"number"},null,8,["value","onUpdate:value"]),l(" 次，每次扣款 "),t(T,{value:e.dedAmonutUpperLimit,"onUpdate:value":o=>e.dedAmonutUpperLimit=o,style:{width:"60px"},type:"number"},null,8,["value","onUpdate:value"]),l(" 元 ")]),n("p",xt,[l(" 迟到> "),t(T,{value:e.timesLowerLimit,"onUpdate:value":o=>e.timesLowerLimit=o,style:{width:"60px"},type:"number",disabled:""},null,8,["value","onUpdate:value"]),l(" 次，每次扣款 "),t(T,{value:e.dedAmonutLowerLimit,"onUpdate:value":o=>e.dedAmonutLowerLimit=o,style:{width:"60px"},type:"number"},null,8,["value","onUpdate:value"]),l(" 元 ")])]),n("div",null,[n("p",It,[l(" 迟到> "),t(T,{value:e.periodLowerLimit,"onUpdate:value":o=>e.periodLowerLimit=o,style:{width:"60px"},type:"number",disabled:""},null,8,["value","onUpdate:value"]),l(" 分钟 ")]),n("div",Et,[n("p",Dt,[l(" 迟到≤ "),t(T,{value:e.isAbsenteeism,"onUpdate:value":o=>e.isAbsenteeism=o,style:{width:"60px"},type:"number",disabled:""},null,8,["value","onUpdate:value"]),l(" 次，每次旷工 "),t(T,{value:e.absenceDays,"onUpdate:value":o=>e.absenceDays=o,style:{width:"60px"},type:"number"},null,8,["value","onUpdate:value"]),l(" 天 ")])])])])])):ne("",!0),e.dedTypeCode=="52000"?(c(),x("div",At,[n("div",Lt,[l(_(e.name)+" ",1),t(Q,{checked:e.isEnable,"onUpdate:checked":o=>e.isEnable=o,size:"small"},null,8,["checked","onUpdate:checked"])]),n("div",Pt,[n("p",Ot,[l(" 早退≤ "),t(T,{value:e.periodUpperLimit,"onUpdate:value":o=>e.periodUpperLimit=o,type:"number",style:{width:"50px"}},null,8,["value","onUpdate:value"]),l(" 分钟 ")]),n("div",Ft,[n("p",$t,[l(" 早退≤ "),t(T,{value:e.timesUpperLimit,"onUpdate:value":o=>e.timesUpperLimit=o,type:"number",style:{width:"50px"}},null,8,["value","onUpdate:value"]),l(" 次，每次扣款 "),t(T,{value:e.dedAmonutUpperLimit,"onUpdate:value":o=>e.dedAmonutUpperLimit=o,type:"number",style:{width:"50px"}},null,8,["value","onUpdate:value"]),l(" 元 ")]),n("p",Bt,[l(" 早退> "),t(T,{value:e.timesLowerLimit,"onUpdate:value":o=>e.timesLowerLimit=o,style:{width:"50px"},type:"number",disabled:""},null,8,["value","onUpdate:value"]),l(" 次，每次扣款 "),t(T,{value:e.dedAmonutLowerLimit,"onUpdate:value":o=>e.dedAmonutLowerLimit=o,style:{width:"50px"},type:"number"},null,8,["value","onUpdate:value"]),l(" 元 ")])]),n("div",null,[n("p",Rt,[l(" 早退> "),t(T,{value:e.periodLowerLimit,"onUpdate:value":o=>e.periodLowerLimit=o,style:{width:"50px"},disabled:"",type:"number"},null,8,["value","onUpdate:value"]),l(" 分钟 ")]),n("div",zt,[n("p",Ht,[l(" 早退≤ "),t(T,{value:e.isAbsenteeism,"onUpdate:value":o=>e.isAbsenteeism=o,style:{width:"50px"},type:"number",disabled:""},null,8,["value","onUpdate:value"]),l(" 次，每次旷工 "),t(T,{value:e.absenceDays,"onUpdate:value":o=>e.absenceDays=o,style:{width:"50px"},type:"number"},null,8,["value","onUpdate:value"]),l(" 天 ")])])])])])):ne("",!0),e.dedTypeCode=="53000"?(c(),x("div",jt,[n("div",Nt,[l(_(e.name)+" ",1),t(Q,{checked:e.isEnable,"onUpdate:checked":o=>e.isEnable=o,size:"small"},null,8,["checked","onUpdate:checked"])]),n("div",Mt,[n("p",qt,[l(" 旷工按 "),t(T,{value:e.fineSalaryMultiples,"onUpdate:value":o=>e.fineSalaryMultiples=o,style:{width:"50px"},type:"number"},null,8,["value","onUpdate:value"]),l(" 倍工资处罚 ")])])])):ne("",!0)]))),256))]),_:1})]),_:1},8,["model"])]),_:1}),t(ie,{key:"overtime",tab:"加班设置"},{default:s(()=>[t(ue,{ref_key:"overtimeFormRef",ref:W,model:h.value,rules:fe,"label-col":{style:{width:"100px"}}},{default:s(()=>[t(w,{label:"部门",name:"departmentId"},{default:s(()=>[t(m,{value:h.value.departmentId,"onUpdate:value":d[5]||(d[5]=e=>h.value.departmentId=e),placeholder:"请选择部门",onChange:se},{default:s(()=>[(c(!0),x(q,null,Y(u.department,e=>(c(),P(p,{value:e.id},{default:s(()=>[l(_(e.name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])]),_:1}),t(w,{label:"加班规则"},{default:s(()=>[(c(!0),x(q,null,Y(h.value.rules,e=>(c(),x("div",null,[n("div",Vt,[n("div",null,[t(Q,{size:"small",checked:e.isEnable,"onUpdate:checked":o=>e.isEnable=o},null,8,["checked","onUpdate:checked"]),l("   "+_(e.rule),1)]),n("div",null,[t(Se,{checked:e.isTimeOff,"onUpdate:checked":o=>e.isTimeOff=o},{default:s(()=>[l("调休假")]),_:2},1032,["checked","onUpdate:checked"]),t(a,{value:e.ruleTime,"onUpdate:value":o=>e.ruleTime=o,format:"HH:mm",valueFormat:"HH:mm",style:{width:"150px"}},null,8,["value","onUpdate:value"])])])]))),256))]),_:1}),t(w,{label:"打卡验证"},{default:s(()=>[t(Q,{size:"small",checked:h.value.isClock,"onUpdate:checked":d[6]||(d[6]=e=>h.value.isClock=e)},null,8,["checked"]),l(" 加班需要有打卡记录 ")]),_:1}),t(w,{label:"开启补偿"},{default:s(()=>[t(Q,{size:"small",checked:h.value.isCompensationint,"onUpdate:checked":d[7]||(d[7]=e=>h.value.isCompensationint=e)},null,8,["checked"])]),_:1}),t(w,{label:"调休假设置",name:"latestEffectDate"},{default:s(()=>[l(" 最晚有效期 次年 "),t(Te,{value:h.value.latestEffectDate,"onUpdate:value":d[8]||(d[8]=e=>h.value.latestEffectDate=e),format:"MM-DD",valueFormat:"MM-DD"},null,8,["value"]),n("div",Kt,[t(de,null,{default:s(()=>[l(" 请假最小单位 "),t(T,{value:h.value.unit,"onUpdate:value":d[9]||(d[9]=e=>h.value.unit=e),style:{width:"50px"},type:"number",onChange:_e},null,8,["value"]),l(" 天 ")]),_:1})])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["activeKey"])])]),_:1},8,["open","confirm-loading"])}}},Z=u=>(tt("data-v-07c44c76"),u=u(),at(),u),Wt={class:"bg-white p-2"},Yt={class:"mt-2 flex items-center"},Gt=Z(()=>n("span",{class:"text-base"},"部门：",-1)),Xt={class:"bg-white p-2 mt-4 w-full relative overflow-x-auto overflow-y-hidden"},Zt={style:{width:"3000px"}},Qt={border:"0",align:"center",cellpadding:"0",cellspacing:"0",class:"tableInfo"},ea=Z(()=>n("th",{width:"30"},"序号",-1)),ta=Z(()=>n("th",{width:"100"},"姓名",-1)),aa=Z(()=>n("th",{width:"100"},"工号",-1)),na=Z(()=>n("th",{width:"200"},"部门",-1)),la=Z(()=>n("th",{width:"100"},"手机",-1)),oa={width:"50"},sa={width:"100"},da={width:"100"},ua={width:"200"},ra={width:"100"},ia=["onClick"],ca={class:"flex justify-between",style:{width:"260px"}},pa=Z(()=>n("p",null,"上班打卡地点："+_("-"),-1)),ma=Z(()=>n("p",null,"下班打卡地点："+_("-"),-1)),va={class:"py-2 px-5"},_a={class:"flex justify-end p-2 bg-white"},fa={__name:"index",setup(u){const z=v([]),G=v([]);ae(()=>{le()});const le=async()=>{const U=await Je();z.value=U},V=(U,i)=>i.some(S=>S.name.toLowerCase().indexOf(U.toLowerCase())>-1),H=()=>{N()},k=v({page:1,pagesize:15,deptID:"",stateID:""}),j=v(!1),b=v([]),L=v(0),g=(U,i)=>{k.page=U,k.pagesize=i,N()},N=async()=>{j.value=!0;const U=await rt({...k.value,deptID:G.value.flat().join(",")});b.value=U;let S=new Date().getFullYear(),W=new Date(S,b.value.monthOfReport,0);L.value=W.getDate(),j.value=!1};ae(()=>{N()});const D=[{id:"1",name:"正常"},{id:"2",name:"旷工"},{id:"3",name:"迟到"},{id:"4",name:"早退"},{id:"5",name:"外出"},{id:"6",name:"出差"},{id:"7",name:"年假"},{id:"8",name:"事假"},{id:"9",name:"病假"},{id:"10",name:"婚假"},{id:"11",name:"丧假"},{id:"12",name:"产假"},{id:"13",name:"奖励产假"},{id:"14",name:"陪产假"},{id:"15",name:"探亲假"},{id:"16",name:"工伤假"},{id:"17",name:"调休"},{id:"18",name:"产检假"},{id:"19",name:"流产假"},{id:"20",name:"长期病假"},{id:"21",name:"补签"},{id:"22",name:"休息"}],I=U=>{const i=D.find(S=>S.id==U);return i?i.name:"-"},E=v(!1),K=v(!1),O=v({}),$=v(1),X=v([]),J=async(U,i,S)=>{await f(U.userId),$.value=S.adtStatu+"",O.value=S,E.value=!0},f=async U=>{const i=await it({userId:U});X.value=i.map(S=>{const W=Object.keys(S)[0];return{label:S[W],value:W}})},M=async()=>{K.value=!0;const{userId:U,department:i,day:S}=O.value;await ct(U,{adtStatu:$.value,userId:U,department:i,day:S}),re.success("考勤状态修改成功!"),N(),K.value=!1,E.value=!1},r=v(!1),A=v(!0),oe=()=>{A.value=!1,r.value=!1,Ye(()=>{A.value=!0})};return(U,i)=>{const S=Ge,W=Xe,h=Ze,ve=Qe,_e=st,fe=et,se=dt,he=Ce;return c(),x(q,null,[n("div",Wt,[t(S,{type:"primary",onClick:i[0]||(i[0]=()=>r.value=!0)},{default:s(()=>[l("设置")]),_:1}),n("div",Yt,[Gt,t(W,{value:C(G),"onUpdate:value":i[1]||(i[1]=F=>ce(G)?G.value=F:null),style:{width:"300px"},multiple:"",options:C(z),placeholder:"请选择部门筛选项","show-search":{filter:V},"field-names":{label:"name",value:"id",children:"children"},"max-tag-count":"responsive",onChange:H},null,8,["value","options","show-search"])])]),t(fe,{spinning:C(j)},{default:s(()=>{var F,y,d,p;return[n("div",Xt,[n("div",Zt,[n("table",Qt,[n("tr",null,[ea,ta,aa,na,la,(c(!0),x(q,null,Y(C(L),(m,w)=>(c(),x("th",{key:w,width:"110"},_(C(b).monthOfReport)+"/"+_(w+1),1))),128))]),(c(!0),x(q,null,Y((y=(F=C(b))==null?void 0:F.data)==null?void 0:y.rows,(m,w)=>(c(),x("tr",{key:m.id},[n("td",oa,_(w+1),1),n("td",sa,_(m.username),1),n("td",da,_(m.workNumber),1),n("td",ua,_(m.departmentName),1),n("td",ra,_(m.mobile),1),(c(!0),x(q,null,Y(m.attendanceRecord,(a,de)=>(c(),x("td",{key:de,width:"110",onClick:ue=>J(m,de,a),class:We(["cursor-pointer",{"bg-green-500":a.adtStatu===1,"bg-red-500":a.adtStatu===2,"bg-yellow-500":a.adtStatu===3,"bg-yellow-400":a.adtStatu===4,"bg-blue-500":a.adtStatu===5,"bg-blue-400":a.adtStatu===6,"bg-blue-300":a.adtStatu===7,"bg-purple-500":a.adtStatu===8||a.adtStatu===9||a.adtStatu===10||a.adtStatu===11||a.adtStatu===12||a.adtStatu===13||a.adtStatu===14||a.adtStatu===15||a.adtStatu===16||a.adtStatu===18||a.adtStatu===19||a.adtStatu===20,"bg-gray-500":a.adtStatu===17,"bg-gray-400":a.adtStatu===21,"bg-gray-300":a.adtStatu===22}])},[t(ve,{placement:"top"},{title:s(()=>[n("div",ca,[n("span",null,_(m.username+"-"+a.day+"-考勤记录"),1),n("span",null,[a.adtStatu===1?(c(),P(h,{key:0,color:"green"},{default:s(()=>[l(_(I(a.adtStatu)),1)]),_:2},1024)):a.adtStatu===2?(c(),P(h,{key:1,color:"red"},{default:s(()=>[l(_(I(a.adtStatu)),1)]),_:2},1024)):a.adtStatu===3||a.adtStatu===4?(c(),P(h,{key:2,color:"orange"},{default:s(()=>[l(_(I(a.adtStatu)),1)]),_:2},1024)):a.adtStatu===5||a.adtStatu===6||a.adtStatu===7?(c(),P(h,{key:3,color:"blue"},{default:s(()=>[l(_(I(a.adtStatu)),1)]),_:2},1024)):a.adtStatu===8||a.adtStatu===9||a.adtStatu===10||a.adtStatu===11||a.adtStatu===12||a.adtStatu===13||a.adtStatu===14||a.adtStatu===15||a.adtStatu===16||a.adtStatu===18||a.adtStatu===19||a.adtStatu===20?(c(),P(h,{key:4,color:"purple"},{default:s(()=>[l(_(I(a.adtStatu)),1)]),_:2},1024)):a.adtStatu===17||a.adtStatu===21||a.adtStatu===22?(c(),P(h,{key:5},{default:s(()=>[l(_(I(a.adtStatu)),1)]),_:2},1024)):ne("",!0)])])]),content:s(()=>[n("p",null,"上班打卡时间："+_(a.adtInTime||"-"),1),pa,n("p",null,"下班打卡时间："+_(a.adtOutTime||"-"),1),ma]),default:s(()=>[n("span",va,_(I(a.adtStatu)),1)]),_:2},1024)],10,ia))),128))]))),128))])])]),n("div",_a,[t(_e,{current:C(k).page,"onUpdate:current":i[2]||(i[2]=m=>C(k).page=m),"page-size":C(k).pagesize,"onUpdate:pageSize":i[3]||(i[3]=m=>C(k).pagesize=m),"show-quick-jumper":"",total:(p=(d=C(b))==null?void 0:d.data)==null?void 0:p.total,"show-total":m=>`共 ${m} 条`,onChange:g},null,8,["current","page-size","total","show-total"])])]}),_:1},8,["spinning"]),t(he,{open:C(E),"onUpdate:open":i[5]||(i[5]=F=>ce(E)?E.value=F:null),onOk:M,destroyOnClose:!0,"confirm-loading":C(K)},{title:s(()=>[l(_(C(O).day)+"（实际工作日考勤方案） ",1)]),default:s(()=>[t(se,{value:C($),"onUpdate:value":i[4]||(i[4]=F=>ce($)?$.value=F:null),options:C(X)},null,8,["value","options"])]),_:1},8,["open","confirm-loading"]),C(z).length&&C(A)?(c(),P(Jt,{key:0,open:C(r),"onUpdate:open":i[6]||(i[6]=F=>ce(r)?r.value=F:null),department:C(z),onCancel:oe},null,8,["open","department"])):ne("",!0)],64)}}},Ua=Ke(fa,[["__scopeId","data-v-07c44c76"]]);export{Ua as default};
